## NAT와 포트포워딩

### NAT

NAT(Network Address Traslation)은 IP패킷의 TCP/UDP포트 숫자와 소스 및 목적지의 IP주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술은 말한다.

패킷에 변화가 생기기 때문에 IP나 TCP/UDP의 체크섬(Checksum)도 다시 계산되어 재기록해야한다.

NAT를 이용하는 이유는 대개 사설 네트워크에 속한 여러 개의 호스트가 하나의 공인 IP주소를 사용하여 인터넷에 접속하기 위함이다.

하지만 꼭 사설 IP로 변환하는 데에만 사용하는 기술은 아니다.

* 3, 4계층 까지도 프로토콜을 다시 만드는 것
* 다시 만들 떄 NAT테이블에 기록한다.

✔ 특정 IP주소의 특정 포트번호로 가는 패킷을 다른 IP주소에 다른 포트번호로 바꿔주는 것



### NAT란?

![image-20220927213522409](10%EC%9E%A5_NAT%EC%99%80_%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20220927213522409.png)

외부에서는 **공인 IP**부분만 보이는 것



### 포트포워딩

### 포트포워딩이란?

포트 포워딩 또는 포트 매핑(port mapping)은 패킷이 라우터나 방화벽과 같은 네트워크 장비를 가로지르는 동안 **특정 IP 주소와 포트 번호의 통신 요청을 특정 다른 IP와 포트 번호로 넘겨주는 **네트워크 주소 변환(NAT)의 응용이다.

이 기법은 게이트웨이(외부망)의 반대쪽에 위치한 사설네크워크에 상주하는 호스트에 대한 서비스를 생성하기 위해 흔히 사용된다.

✔ 일반적으로 서버가 사설 네트워크 대역에 있을 때 그 네트워크 대역을 설정하는 공유기, 라우터등 3계층 장비에서 제공을 해주는 기능

![image-20220927213817912](10%EC%9E%A5_NAT%EC%99%80_%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20220927213817912.png)

사설 IP 대역의 컴퓨터가 보이지 않는 사설 IP대역 컴퓨터로 직접 통신하고 싶다.

직접 그 컴퓨터의 IP를 치는 것이 아닌 공인 IP로 보내고 그 공유기에 포트 포워딩 설정을 해둔다.

**예**

![image-20220927213944479](10%EC%9E%A5_NAT%EC%99%80_%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20220927213944479.png)

![image-20220927214058116](10%EC%9E%A5_NAT%EC%99%80_%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20220927214058116.png)

✔ 공유기가 **"특정 포트로 들어온 요청을 다른 특정 IP의 특정 포트로 전송"**하는 처리를 해준다.

![image-20220927214150555](10%EC%9E%A5_NAT%EC%99%80_%ED%8F%AC%ED%8A%B8%ED%8F%AC%EC%9B%8C%EB%94%A9.assets/image-20220927214150555.png)

✔ 안쪽에 있던 보이지 않던 사설 IP에 전달해준다.