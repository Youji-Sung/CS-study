## 임계영역

여러 프로세스, 스레드가 `공유 자원`에 접근할 때 순서 등의 이유로 결과가 달라지는 코드 영역

한 번에 하나의 프로세스만 접근할 수 있도록 제한을 둬야 한다

- `잠금(lock)`을 통해 해결





## 뮤텍스

> 임계 구역을 가진 스레드들이 서로 겹치지 않고 단독으로 실행되도록 하는 기술
>
> 상호 배제(Mutual Exclusion)의 약자

프로세스나 스레드가 공유 자원을 `lock()`을 통해 잠금 설정하고 사용한 후에는 `unlock()`을 통해 잠금 해제하는 객체

- lock: 현재 임계 구역에 들어갈 권한을 얻어옴 (만약 다른 프로세스/스레드가 임계 구역 수행 중이면 종료할 때까지 대기)
- unlock: 현재 임계 구역을 모두 사용했음을 알림 (대기 중인 다른 프로세스/스레드가 임계 구역에 진입할 수 있다)

**뮤텍스 객체를 두 스레드가 동시에 사용할 수 없다**

`이진 세마포어`이기도 하다

![image](https://user-images.githubusercontent.com/97648258/229970948-c637154a-2908-4453-9207-8afb2af35598.png)





## 세마포어

> 멀티 프로그래밍 환경에서 공유된 자원에 대한 접근을 제한하는 방법
>
> 일반화된 뮤텍스

- 간단한 정수값
- wait(또는 P) 함수: 자신의 차례가 올 때까지 기다리는 함수
- signal(또는 V) 함수: 다음 프로세스로 순서를 넘겨주는 함수

로 공유 자원에 대한 접근을 처리한다

![image](https://user-images.githubusercontent.com/97648258/229974008-f3e2e41b-9e4e-4266-abdd-97c142eff5ea.png)



### 바이너리 세마포어

> 0과 1의 두 가지 값만 가질 수 있는 세마포어

구현의 유사성으로 뮤텍스는 바이너리 세마포어라고 할 수도 있다

- 뮤텍스는 잠금을 기반으로 상호배제가 일어나는 `잠금 메커니즘`
- 세마포어는 신호를 기반으로 상호배제가 일어나는 `신호 메커니즘`



### 카운팅 세마포어

> 여러 개의 값을 가질 수 있는 세마포어

여러 자원에 대한 접근을 제어하는데 사용됨





## 차이점

|                    | 뮤텍스                                                       | 세마포어                                                     |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 동기화 대상의 개수 | 1개                                                          | 1개 이상                                                     |
|                    | 0, 1로 이루어짐<br />Binary Semaphore                        | 뮤텍스가 될 수 있다                                          |
| 자원 소유          | 가능                                                         | 불가능                                                       |
|                    | 뮤텍스를 소유하고 있는 스레드만이 Mutex 해제 가능            | 세마포어를 소유하지 않는 스레드가 Semaphore를 해제할 수 있다 |
| 범위               | 프로세스의 범위를 가진다<br />프로세스가 종료되면 자동으로 Clean Up된다 | 시스템 범위에 걸쳐 있다<br />파일 시스템 상의 파일로 존재한다 |



- `데이터 무결성`을 보장할 수 없다

- 모든 `교착 상태`를 해결하지는 못한다

- `상호배제`를 위한 기본적인 기법







## 참고

- 면접을 위한 CS 전공지식 노트
- https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/Semaphore%20%26%20Mutex.md
- https://velog.io/@heetaeheo/%EB%AE%A4%ED%85%8D%EC%8A%A4Mutex%EC%99%80-%EC%84%B8%EB%A7%88%ED%8F%AC%EC%96%B4Semaphore%EC%9D%98-%EC%B0%A8%EC%9D%B4